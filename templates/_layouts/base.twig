{% set isDebug = craft.app.request.getParam('debug') %}
{% set currentSite = craft.app.sites.currentSite %}
<!doctype html>
<html lang="{{ currentSite.language }}" class="has-no-js is-not-pointer-device is-not-touch-device dom-is-loading" {% if isDebug|length %}debug="true"{% endif %} data-csrf="{{ craft.app.request.csrfToken }}" data-cachebust="{{ craft.papertrain.getCachebustTimestamp }}">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        {# SEO Start #}
        {% set seo = getSeoField() %}
        {% if seo is null or seo.title == '' %}
            {% if entry is defined %}
                {% set seo = craft.seo.custom(entry.title, '', false) %}
            {% elseif category is defined %}
                {% set seo = craft.seo.custom(category.title, '', false) %}
            {% elseif product is defined %}
                {% set seo = craft.seo.custom(product.title, '', false) %}
            {% else %}
                {% set seo = craft.seo.custom('MISSING', '', false) %}
            {% endif %}
        {% endif -%}

        {% set locale = craft.app.locale %}
        {% set locales = craft.app.i18n.siteLocaleIds|without(locale) %}

        <title>{{ (seo.title|slice(0,7) == 'MISSING') ? 'REPLACE ME' : seo.title }}</title>
        <meta name="description" content="{{ seo.description }}" />

        {% set fb = seo.social.facebook -%}
        <meta property="fb:app_id" content="{{ fb.handle }}">
        <meta property="og:url" content="{{ craft.app.request.absoluteUrl }}" />
        <meta property="og:type" content="website" />
        <meta property="og:title" content="{{ fb.title }}" />
        <meta property="og:image" content="{{ craft.seo.facebookImage(fb.image) }}" />
        <meta property="og:description" content="{{ fb.description }}" />
        <meta property="og:site_name" content="{{ siteName }}" />
        <meta property="og:locale" content="{{ locale|replace('-', '_') }}" />
        {% for locale in locales -%}
            <meta property="og:locale:alternate" content="{{ locale|replace('-', '_') }}" />
        {% endfor %}

        {% set tw = seo.social.twitter -%}
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:site" content="{{ tw.handle }}" />
        <meta name="twitter:url" content="{{ craft.app.request.absoluteUrl }}" />
        <meta name="twitter:title" content="{{ tw.title }}" />
        <meta name="twitter:description" content="{{ tw.description }}" />
        <meta name="twitter:image" content="{{ craft.seo.twitterImage(tw.image) }}" />

        {% if seo.robots -%}
            <meta name="robots" content="{{ seo.robots }}" />
        {% endif %}
        {%- if seo.expiry -%}
            <meta name="robots" content="unavailable_after: {{ seo.expiry }}" />
        {% endif %}

        <link rel="home" href="{{ alias('@rootUrl') }}" />
        <link rel="canonical" href="{{ seo.canonical }}">
        {# SEO End #}

        {# Android Navigaiton Bar Theme Colour #}
        <meta name="theme-color" content="#1FB6FF">

        {# Icons #}
        <link rel="icon" sizes="192x192" href="{{ alias('@rootUrl')|trim('/') }}/assets/images/icon-192.png">
        <link rel="apple-touch-icon" href="{{ alias('@rootUrl')|trim('/') }}/assets/images/ios-icon.png">
        <meta name="msapplication-square310x310logo" content="{{ alias('@rootUrl')|trim('/') }}/assets/images/icon-310.png">

        {# PWA Manifest #}
        {# <link rel="manifest" href="{{ alias('@rootUrl')|trim('/') }}/manifest.json"> #}

        <!-- Required global variables -->
        <script>
            modules = {};
            window.stylesheets = [];
            window.packages = [];
            window.components = [];
        </script>

        <!-- Loading animation -->
        <style>
            .c-transition{
                width: 100vw;
                height: 4px;
                width: 100vw;
                height: 4px;
                position: fixed;
                top: 0;
                left: 0;
                z-index: 999999;
                transform: translate3d(0, -101%, 0);
                transition: transform 125ms cubic-bezier(0.4, 0.0, 0.6, 1);
                background: #fafafa;
                overflow: hidden;
                display: inline-block;
                opacity: 0;
                user-select: none;
                pointer-events: none;
            }

            html.dom-is-loading *{
                cursor: wait !important;
            }

            html.dom-is-loading .c-transition{
                transform: translate3d(0, 0, 0);
                opacity: 1;
                transition: transform 150ms cubic-bezier(0.0, 0.0, 0.2, 1);
            }

            html.dom-is-loading .c-transition .c-transition_primary{
                animation: primaryBar 2s infinite linear;
            }

            html.dom-is-loading .c-transition .c-transition_primary:before{
                animation: primaryScale 2s infinite linear;
            }

            html.dom-is-loading .c-transition .c-transition_secondary{
                animation: secondaryBar 2s infinite linear;
            }

            html.dom-is-loading .c-transition .c-transition_secondary:before{
                animation: secondaryScale 2s infinite linear;
            }

            .c-transition .c-transition_primary{
                left: -145%;
                position: absolute;
                width: 100%;
                height: 100%;
            }

            .c-transition .c-transition_primary::before{
                content: "";
                background: #3b83f9;
                display: inline-block;
                position: absolute;
                width: 100%;
                height: 100%;
            }

            .c-transition .c-transition_secondary{
                left: -54%;
                position: absolute;
                width: 100%;
                height: 100%;
            }

            .c-transition .c-transition_secondary::before{
                content: "";
                background: #3b83f9;
                display: inline-block;
                position: absolute;
                width: 100%;
                height: 100%;
            }

            @keyframes primaryBar{
                0%{
                    transform: translateX(0);
                }
                20%{
                    transform: translateX(0);
                    animation-timing-function: cubic-bezier(.5,0,.70173,.49582);
                }
                59%{
                    transform: translateX(83.67142%);
                    animation-timing-function: cubic-bezier(.30244,.38135,.55,.95635);
                }
                100%{
                    transform: translateX(200.61106%);
                }
            }

            @keyframes secondaryBar{
                0%{
                    transform: translateX(0);
                    animation-timing-function: cubic-bezier(.15,0,.51506,.40969);
                }
                25%{
                    animation-timing-function: cubic-bezier(.31033,.28406,.8,.73371);
                    transform: translateX(37.65191%);
                }
                48.35%{
                    animation-timing-function: cubic-bezier(.4,.62704,.6,.90203);
                    transform: translateX(84.38617%);
                }
                100%{
                    transform: translateX(160.27778%);
                }
            }

            @keyframes primaryScale{
                0%{
                    transform: scaleX(.08);
                }
                36%{
                    animation-timing-function: cubic-bezier(.33473,.12482,.78584,1);
                    transform: scaleX(.08);
                }
                69%{
                    animation-timing-function: cubic-bezier(.06,.11,.6,1);
                    transform: scaleX(.66148);
                }
                100%{
                    transform: scaleX(.08);
                }
            }

            @keyframes secondaryScale{
                0%{
                    animation-timing-function: cubic-bezier(.20503,.05705,.57661,.45397);
                    transform: scaleX(.08);
                }
                19%{
                    animation-timing-function: cubic-bezier(.15231,.19643,.64837,1.00432);
                    transform: scaleX(.4571);
                }
                44%{
                    animation-timing-function: cubic-bezier(.25776,-.00316,.21176,1.38179);
                    transform: scaleX(.72796);
                }
                100%{
                    transform: scaleX(.08);
                }
            }
        </style>

        <!-- Reset CSS-->
        <style>
            *,
            *::before,
            *::after{
                box-sizing: border-box;
                -webkit-tap-highlight-color: transparent;
                border: none;
                outline: none;
                position: relative;
                display: inline-block;
            }
            html, body, div, span, button, applet, object, input, textarea, select iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed,  figure, figcaption, footer, header, hgroup,  menu, nav, output, ruby, section, summary, time, mark, audio, video {  
                position: relative;
                margin: 0;
                padding: 0;  
                border: 0;  
                font-size: 100%;
                font: inherit;  
                vertical-align: baseline; 
                outline: none;
                box-shadow: none;
                text-decoration: none;
                color: inherit;
                background-color: transparent;
            }
            input::-webkit-inner-spin-button,
            input::-webkit-outer-spin-button,
            input[type=number]
            {
                -webkit-appearance: none;
                -moz-appearance: textfield;
            }
            input[type=color]::-webkit-color-swatch-wrapper,
            input[type=color]::-webkit-color-swatch
            {
                padding: 0;
                border: none;
            }

            template,
            style,
            script,
            title{
                display: none !important;
            }
            button{
                user-select: none;
            }
            svg{
                width: 24px;
                height: 24px;
            }
        </style>

        <!-- Required CSS -->
        {% include "_layouts/global-css.twig" %}
    </head>
    <body>

        <!-- Required Runtime JavaScript -->
        {# {% include "_layouts/global-javascript.twig" %} #}

        {% spaceless %}
            <div class="c-transition">
                <div class="c-transition_primary"></div>
                <div class="c-transition_secondary"></div>
            </div>
            {% block page %}{% endblock %}
        {% endspaceless %}

        {% set applicationPaths = craft.papertrain.getAssetPaths(['runtime']) %}
        <script type="module" src="{{ alias('@rootUrl')|trim('/') ~ '/automation/modules/runtime.js' }}"></script>

        <noscript>
            <div style="position:fixed;bottom:0;left:0;padding:16px 32px;border-radius:8px 8px 0 0;text-align:center;background-color:#ffffff;box-shadow:0 -1px 3px rgba(0,0,0,0.15), 0 -4px 32px rgba(0,0,0,0.1);left:50%;transform:translateX(-50%);z-index:99999;">
                <p>{{ "This website requires JavaScript to function. Please enable JavaScript and refresh the page."|t }}</p>
            </div>
        </noscript>
    </body>
</html>
